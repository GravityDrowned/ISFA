<?xml version='1.0' encoding='UTF-8'?>
<omdoc xml:id="A000089.omdoc" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:omdoc="http://omdoc.org/ns" xmlns="http://omdoc.org/ns">
        <!--This OMDoc file is generated from an OEIS entry, do not edit-->
        <theory name="A000089">
          <assertion class="***** TTTT *****">
      <CMP></CMP>
    </assertion><omtext class="starts-with">
      <CMP> 1,1,0,0,2,0,0,0,0,2,0,0,2,0,0,0,2,0,0,0,0,0,0,0,2,2,0,0,2,0,0,0,0,2,</CMP>
    </omtext><assertion class="***** UUUU *****">
      <CMP> 0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,2,0,0,2,0,0,0,4,0,0,0,</CMP>
    </assertion><assertion class="***** IIII *****">
      <CMP> 0,0,0,0,2,2,0,0,0,0,0,0,0,2,0,0,4,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0</CMP>
    </assertion><omtext class="name">
      <CMP> Number of solutions to x^2 + 1 == 0 (mod n).</CMP>
    </omtext><omtext class="comment">
      <CMP> Number of elliptic points of order 2 for GAMMA_0(n).</CMP>
    </omtext><omtext class="comment">
      <CMP> The Dirichlet inverse, 1, -1, 0, 1, -2, 0, 0, -1, 0, 2, 0, 0, -2, 0,.. seems to equal A091400, apart from signs. - _R. J. Mathar_, Jul 15 2010</CMP>
    </omtext><omtext class="comment">
      <CMP> Shadow transform of A002522. - _Michel Marcus_, Jun 06 2013</CMP>
    </omtext><omtext class="comment">
      <CMP> a(n) != 0 iff n in A008784. - _Joerg Arndt_, Mar 26 2014</CMP>
    </omtext><omtext class="reference">
      <CMP> M. Baake, &quot;Solution of coincidence problem...&quot;, in R. V. Moody, ed., Math. of Long-Range Aperiodic Order, Kluwer 1997, pp. 9-44.</CMP>
    </omtext><omtext class="reference">
      <CMP> G. Shimura, Introduction to the Arithmetic Theory of Automorphic Functions, Princeton, 1971, see p. 25, Eq. (2).</CMP>
    </omtext><omtext class="link">
      <CMP> T. D. Noe, &lt;a href=&quot;/A000089/b000089.txt&quot;&gt;Table of n, a(n) for n = 1..2000&lt;/a&gt;</CMP>
    </omtext><omtext class="link">
      <CMP> M. Baake and U. Grimm, &lt;a href=&quot;http://www.ma.utexas.edu/mp_arc-bin/mpa?yn=02-392&quot;&gt;Quasicrystalline combinatorics&lt;/a&gt;</CMP>
    </omtext><omtext class="link">
      <CMP> Fell, Harriet; Newman, Morris; Ordman, Edward; &lt;a href=&quot;http://archive.org/details/jresv67Bn1p61&quot;&gt;Tables of genera of groups of linear fractional transformations&lt;/a&gt;, J. Res. Nat. Bur. Standards Sect. B 67B 1963 61-68.</CMP>
    </omtext><omtext class="link">
      <CMP> S. R. Finch and Pascal Sebah, &lt;a href=&quot;http://arXiv.org/abs/math.NT/0604465&quot;&gt;Squares and Cubes Modulo n&lt;/a&gt; (arXiv:math.NT/0604465).</CMP>
    </omtext><omtext class="link">
      <CMP> John S. Rutherford, &lt;a href=&quot;http://dx.doi.org/10.1107/S010876730804333X&quot;&gt;Sublattice enumeration. IV. Equivalence classes of plane sublattices by parent Patterson symmetry and colour lattice group type&lt;/a&gt;, Acta Cryst. (2009). A65, 156-163. [See Table 4].</CMP>
    </omtext><omtext class="link">
      <CMP> N. J. A. Sloane, &lt;a href=&quot;/transforms.txt&quot;&gt;Transforms&lt;/a&gt;</CMP>
    </omtext><omdoc:p class="formula">
        <CMP>
        <OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A000089"/>
      <OMV name="n"/>
    </OMA>
      <OMI>0</OMI>
    </OMA>
    </OMOBJ> if 4|n, else a(n) = Product_{ p | N } (1 + Legendre(-1, p) ), where we use the definition that<OMOBJ>
      <OMA>
      <OMS name="Legendre" cd="A000089"/>
      <OMA>
      <OMS name="unary_minus"/>
      <OMI>1</OMI>
    </OMA>
    </OMA>
    </OMOBJ>, 2) = 0,<OMOBJ>
      <OMA>
      <OMS name="Legendre" cd="A000089"/>
      <OMA>
      <OMS name="unary_minus"/>
      <OMI>1</OMI>
    </OMA>
    </OMA>
    </OMOBJ>, p) = 1 if<OMOBJ>
      <OMA>
      <OMS name="==" cd="arithmetic"/>
      <OMV name="p"/>
      <OMI>1</OMI>
    </OMA>
    </OMOBJ> mod<OMOBJ>
      <OMI>4</OMI>
    </OMOBJ>, = -1 if<OMOBJ>
      <OMA>
      <OMS name="==" cd="arithmetic"/>
      <OMV name="p"/>
      <OMI>3</OMI>
    </OMA>
    </OMOBJ> mod<OMOBJ>
      <OMI>4</OMI>
    </OMOBJ>. This is Shimura's definition, which is different from Maple's.
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
         Dirichlet series: (1+2^(-s))*Product (1+p^(-s))/(1-p^(-s)) (p=1 mod 4).
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
         Multiplicative with<OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A000089"/>
      <OMA>
      <OMS name="power" cd="arithmetics"/>
      <OMV name="p"/>
      <OMV name="e"/>
    </OMA>
    </OMA>
      <OMI>1</OMI>
    </OMA>
    </OMOBJ> if<OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMV name="p"/>
      <OMI>2</OMI>
    </OMA>
    </OMOBJ> and<OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMV name="e"/>
      <OMI>1</OMI>
    </OMA>
    </OMOBJ>;<OMOBJ>
      <OMI>0</OMI>
    </OMOBJ> if<OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMV name="p"/>
      <OMI>2</OMI>
    </OMA>
    </OMOBJ> and<OMOBJ>
      <OMA>
      <OMS name="&gt;" cd="arithmetic"/>
      <OMV name="e"/>
      <OMI>1</OMI>
    </OMA>
    </OMOBJ>;<OMOBJ>
      <OMI>2</OMI>
    </OMOBJ> if<OMOBJ>
      <OMA>
      <OMS name="==" cd="arithmetic"/>
      <OMV name="p"/>
      <OMA><OMS name="times"/><OMI>1</OMI><OMA>
      <OMS name="mod" cd="A000089"/>
      <OMI>4</OMI>
    </OMA></OMA>
    </OMA>
    </OMOBJ>;<OMOBJ>
      <OMI>0</OMI>
    </OMOBJ> if<OMOBJ>
      <OMA>
      <OMS name="==" cd="arithmetic"/>
      <OMV name="p"/>
      <OMA><OMS name="times"/><OMI>3</OMI><OMA>
      <OMS name="mod" cd="A000089"/>
      <OMI>4</OMI>
    </OMA></OMA>
    </OMA>
    </OMOBJ>. - _David W. Wilson_, Aug 01 2001
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
        <OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A000089"/>
      <OMA><OMS name="times"/><OMI>3</OMI><OMV name="n"/></OMA>
    </OMA>
      <OMA>
      <OMS name="a" cd="A000089"/>
      <OMA><OMS name="times"/><OMI>4</OMI><OMV name="n"/></OMA>
    </OMA>
    </OMA>
      <OMA>
      <OMS name="a" cd="A000089"/>
      <OMA>
      <OMS name="plus" cd="arithmetics"/>
      <OMA><OMS name="times"/><OMI>4</OMI><OMV name="n"/></OMA><OMI>3</OMI>
    </OMA>
    </OMA>
    </OMA>
      <OMI>0</OMI>
    </OMA>
    </OMOBJ>.<OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A000089"/>
      <OMA>
      <OMS name="plus" cd="arithmetics"/>
      <OMA><OMS name="times"/><OMI>4</OMI><OMV name="n"/></OMA><OMI>1</OMI>
    </OMA>
    </OMA>
      <OMA>
      <OMR xref="A031358"/>
      <OMV name="n"/>
    </OMA>
    </OMA>
    </OMOBJ>. - _Michael Somos_, Mar 24 2012
      </CMP>
      </omdoc:p><assertion class="example">
      <CMP> x + x^2 + 2*x^5 + 2*x^10 + 2*x^13 + 2*x^17 + 2*x^25 + 2*x^26 + 2*x^29 + ...</CMP>
    </assertion><omtext class="maple">
      <CMP> with(numtheory); A000089 := proc (n) local i, s; if modp(n,4) = 0 then RETURN(0) fi; s := 1; for i in divisors(n) do if isprime(i) and i &gt; 2 then s := s*(1+eval(legendre(-1,i))) fi od; s end: # _Gene Ward Smith_, May 22 2006</CMP>
    </omtext><omtext class="mathematica">
      <CMP> Array[ Function[ n, If[ EvenQ[ n ] || Mod[ n, 3 ]==2, 0, Count[ Array[ Mod[ #^2+1, n ]&amp;, n, 0 ], 0 ] ] ], 84 ]</CMP>
    </omtext><omtext class="program">
      <CMP> (PARI) a(n) = if( n&lt;1, 0, sum( x=0, n-1, (x^2 + 1)%n==0)) /* _Michael Somos_, Mar 24 2012 */</CMP>
    </omtext><omtext class="program">
      <CMP> (PARI) a(n)=my(o=valuation(n,2),f);if(o&gt;1,0,n&gt;&gt;=o;f=factor(n)[,1]; prod(i=1,#f,kronecker(-1,f[i])+1)) \\ _Charles R Greathouse IV_, Jul 08 2013</CMP>
    </omtext><omtext class="program">
      <CMP> (Haskell)</CMP>
    </omtext><omtext class="program">
      <CMP> a000089 n = product $ zipWith f (a027748_row n) (a124010_row n) where</CMP>
    </omtext><omtext class="program">
      <CMP>    f 2 e = if e == 1 then 1 else 0</CMP>
    </omtext><omtext class="program">
      <CMP>    f p _ = if p `mod` 4 == 1 then 2 else 0</CMP>
    </omtext><omtext class="program">
      <CMP> -- _Reinhard Zumkeller_, Mar 24 2012</CMP>
    </omtext><assertion class="crossref">
      <CMP> Cf. A031358, A027748, A124010, A000095.</CMP>
    </assertion><assertion class="keywords">
      <CMP> nonn,nice,mult</CMP>
    </assertion><assertion class="offset">
      <CMP> 1,5</CMP>
    </assertion><assertion class="author">
      <CMP> _N. J. A. Sloane_</CMP>
    </assertion>
        </theory>
      </omdoc>