<?xml version='1.0' encoding='UTF-8'?>
<omdoc xml:id="A246675.omdoc" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:omdoc="http://omdoc.org/ns" xmlns="http://omdoc.org/ns">
        <!--This OMDoc file is generated from an OEIS entry, do not edit-->
        <theory name="A246675">
          <assertion class="***** TTTT *****">
      <CMP></CMP>
    </assertion><omtext class="starts-with">
      <CMP> 1,2,3,4,5,8,7,6,9,16,11,32,13,10,15,64,17,128,19,18,21,256,23,12,25,</CMP>
    </omtext><assertion class="***** UUUU *****">
      <CMP> 14,27,512,29,1024,31,26,33,20,35,2048,37,42,39,4096,41,8192,43,22,45,</CMP>
    </assertion><assertion class="***** IIII *****">
      <CMP> 16384,47,24,49,50,51,32768,53,36,55,66,57,65536,59,131072,61,38,63,52,65,262144,67,74,69</CMP>
    </assertion><omtext class="name">
      <CMP> Permutation of natural numbers: a(n) = A000079(A055396(n+1)-1) * ((2*A246277(n+1))-1).</CMP>
    </omtext><omtext class="comment">
      <CMP> Consider the square array A246278, and also A246275 which is obtained from the former when one is subtracted from each term.</CMP>
    </omtext><omtext class="comment">
      <CMP> In A246278 the even numbers occur at the top row, and all the rows below that contain only odd numbers, those subsequent terms in each column having been obtained by shifting all primes present in the prime factorization of number immediately above to one larger indices with A003961.</CMP>
    </omtext><omtext class="comment">
      <CMP> To compute a(n): we do the same process in reverse, by shifting primes in the prime factorization of n+1 step by step to smaller primes, until after k &gt;= 0 such shifts with A064989, the result is even, with the smallest prime present being 2.</CMP>
    </omtext><omtext class="comment">
      <CMP> We subtract one from this even number and shift the binary expansion of the resulting odd number k positions left (i.e. multiply it with 2^k), which will be the result of a(n).</CMP>
    </omtext><omtext class="comment">
      <CMP> In the essence, a(n) tells which number in the array A135764 is at the same position where n is in the array A246275. As the topmost row in both arrays is A005408 (odd numbers), they are fixed, i.e. a(2n+1) = 2n+1 for all n.</CMP>
    </omtext><omtext class="comment">
      <CMP> A055396(n+1) tells on which row of A246275 n is, which is equal to the row of A246278 on which n+1 is.</CMP>
    </omtext><omtext class="comment">
      <CMP> A246277(n+1) tells in which column of A246275 n is, which is equal to the column of A246278 in which n+1 is.</CMP>
    </omtext><omtext class="link">
      <CMP> Antti Karttunen, &lt;a href=&quot;/A246675/b246675.txt&quot;&gt;Table of n, a(n) for n = 1..2048&lt;/a&gt;</CMP>
    </omtext><omtext class="link">
      <CMP> &lt;a href=&quot;/index/Per#IntegerPermutation&quot;&gt;Index entries for sequences that are permutations of the natural numbers&lt;/a&gt;</CMP>
    </omtext><omdoc:p class="formula">
        <CMP>
      <OMOBJ>
        <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A246675"/>
      <OMV name="n"/>
    </OMA>
      <OMA><OMS name="times"/><OMA>
      <OMR xref="A000079"/>
      <OMA>
      <OMS name="minus" cd="arithmetics"/>
      <OMA>
      <OMR xref="A055396"/>
      <OMA>
      <OMS name="plus" cd="arithmetics"/>
      <OMV name="n"/><OMI>1</OMI>
    </OMA>
    </OMA><OMI>1</OMI>
    </OMA>
    </OMA><OMA>
      <OMS name="minus" cd="arithmetics"/>
      <OMA><OMS name="times"/><OMI>2</OMI><OMA>
      <OMR xref="A246277"/>
      <OMA>
      <OMS name="plus" cd="arithmetics"/>
      <OMV name="n"/><OMI>1</OMI>
    </OMA>
    </OMA></OMA><OMI>1</OMI>
    </OMA></OMA>
    </OMA>
      </OMOBJ>.
    </CMP>
    </omdoc:p><omdoc:p class="formula">
        <CMP>
      As a composition of related permutations :
    </CMP>
    </omdoc:p><omdoc:p class="formula">
        <CMP>
      <OMOBJ>
        <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A246675"/>
      <OMV name="n"/>
    </OMA>
      <OMA>
      <OMR xref="A135764"/>
      <OMA>
      <OMR xref="A246276"/>
      <OMV name="n"/>
    </OMA>
    </OMA>
    </OMA>
      </OMOBJ>.
    </CMP>
    </omdoc:p><omdoc:p class="formula">
        <CMP>
      <OMOBJ>
        <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A246675"/>
      <OMV name="n"/>
    </OMA>
      <OMA>
      <OMR xref="A054582"/>
      <OMA>
      <OMS name="minus" cd="arithmetics"/>
      <OMA>
      <OMR xref="A246274"/>
      <OMV name="n"/>
    </OMA><OMI>1</OMI>
    </OMA>
    </OMA>
    </OMA>
      </OMOBJ>.
    </CMP>
    </omdoc:p><omdoc:p class="formula">
        <CMP>
      Other identities .For all <OMOBJ>
        <OMA>
      <OMS name="&gt;=" cd="arithmetic"/>
      <OMV name="n"/>
      <OMI>0</OMI>
    </OMA>
      </OMOBJ>:
    </CMP>
    </omdoc:p><omdoc:p class="formula">
        <CMP>
      <OMOBJ>
        <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A246675"/>
      <OMA>
      <OMR xref="A005408"/>
      <OMV name="n"/>
    </OMA>
    </OMA>
      <OMA>
      <OMR xref="A005408"/>
      <OMV name="n"/>
    </OMA>
    </OMA>
      </OMOBJ>.[Fixes the odd numbers ].
    </CMP>
    </omdoc:p><assertion class="example">
      <CMP> Consider 54 = 55-1. To find 55's position in array A246278, we start shifting its prime factorization 55 = 5 * 11 = p_3 * p_5, step by step: p_2 * p_4 (= 3 * 7 = 21), until we get an even number: p_1 * p_3 = 2*5 = 10.</CMP>
    </assertion><assertion class="example">
      <CMP> This tells that 55 is on the row 3 and column 5 (= 10/2) of array A246278, thus 54 occurs in the same position at array A246275. In array A135764 the same position contains number (2^(3-1)) * (10-1) = 4*9 = 36, thus a(54) = 36.</CMP>
    </assertion><omtext class="program">
      <CMP> (PARI)</CMP>
    </omtext><omtext class="program">
      <CMP> A064989(n) = {my(f); f = factor(n); if((n&gt;1 &amp;&amp; f[1,1]==2), f[1,2] = 0); for (i=1, #f~, f[i,1] = precprime(f[i,1]-1)); factorback(f)};</CMP>
    </omtext><omtext class="program">
      <CMP> A246675(n) = { my(k=0); n++; while((n%2), n = A064989(n); k++); n--; while(k&gt;0, n = 2*n; k--); n; };</CMP>
    </omtext><omtext class="program">
      <CMP> for(n=1, 2048, write(&quot;b246675.txt&quot;, n, &quot; &quot;, A246675(n)));</CMP>
    </omtext><omtext class="program">
      <CMP> (Scheme) (define (A246675 n) (* (A000079 (- (A055396 (+ 1 n)) 1)) (-1+ (* 2 (A246277 (+ 1 n))))))</CMP>
    </omtext><assertion class="crossref">
      <CMP> Inverse: A246676.</CMP>
    </assertion><assertion class="crossref">
      <CMP> More recursed variants: A246677, A246683.</CMP>
    </assertion><assertion class="crossref">
      <CMP> Even bisection halved: A246679.</CMP>
    </assertion><assertion class="crossref">
      <CMP> Other related permutations: A054582, A135764, A246274, A246275, A246276.</CMP>
    </assertion><assertion class="crossref">
      <CMP> Cf. A000079, A003961, A005408, A055396, A064989, A246277, A246278.</CMP>
    </assertion><assertion class="crossref">
      <CMP> a(n) differs from A156552(n+1) for the first time at n=13, where a(13) = 14, while A156552(14) = 17.</CMP>
    </assertion><assertion class="keywords">
      <CMP> nonn</CMP>
    </assertion><assertion class="offset">
      <CMP> 1,2</CMP>
    </assertion><assertion class="author">
      <CMP> _Antti Karttunen_, Sep 01 2014</CMP>
    </assertion>
        </theory>
      </omdoc>