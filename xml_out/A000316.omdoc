<?xml version='1.0' encoding='UTF-8'?>
<omdoc xml:id="A000316.omdoc" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:omdoc="http://omdoc.org/ns" xmlns="http://omdoc.org/ns">
        <!--This OMDoc file is generated from an OEIS entry, do not edit-->
        <theory name="A000316">
          <assertion class="***** TTTT *****">
      <CMP> M3702 N1513</CMP>
    </assertion><omtext class="starts-with">
      <CMP> 0,4,80,4752,440192,59245120,10930514688,2649865335040,</CMP>
    </omtext><assertion class="***** UUUU *****">
      <CMP> 817154768973824,312426715251262464,145060238642780180480,</CMP>
    </assertion><assertion class="***** IIII *****">
      <CMP> 80403174342119992692736,52443098500204184915312640,39764049487996490505336537088</CMP>
    </assertion><omtext class="name">
      <CMP> Number of permutations with no hits on 2 main diagonals.</CMP>
    </omtext><omtext class="comment">
      <CMP> Two decks each have n kinds of cards, 2 of each kind. The first deck is laid out in order. The second deck is shuffled and laid out next to the first. A match occurs if a card from the second deck is next to a card of the same kind from the first deck. A(n) is the number of ways of achieving no matches. The probability of no matches is a(n)/(2n)!.</CMP>
    </omtext><omtext class="comment">
      <CMP> n couples meet for a party and they exchange gifts. Each of the 2n writes their name on a piece of paper and puts it into a hat. They take turns drawing names and give their gift to the person whose name they drew. If anyone draws either their own name or the name of their partner, everyone puts the name they have drawn back into the hat and everyone draws anew. a(n) is the number of different permissible drawings. - _Dan Dima_, Dec 17 2006</CMP>
    </omtext><omtext class="comment">
      <CMP> (2n)! / a(n) is the expected number of deck shuffles until no matches occur. a(n) / (2n)! is the probability for a permissible drawing to be achieved. (2n)! / a(n) is the expected number of drawings before a permissible drawing is achieved. As n goes to infinity (2n)! / a(n) will strictly decrease very slowly to e^2 ~ 7.38906 (starting from n &gt; 2) - _Dan Dima_, Dec 17 2006</CMP>
    </omtext><omtext class="comment">
      <CMP> a(n) equals the permanent of the (2n)X(2n) matrix with 0's along the main diagonal and the anti-diagonal, and 1's everywhere else. [John M. Campbell, Jul 11 2011]</CMP>
    </omtext><omtext class="reference">
      <CMP> F. N. David and D. E. Barton, Combinatorial Chance, Hafner, NY, 1962, Ch. 7 and Ch. 12.</CMP>
    </omtext><omtext class="reference">
      <CMP> J. Riordan, An Introduction to Combinatorial Analysis, Wiley, 1958, p. 187.</CMP>
    </omtext><omtext class="reference">
      <CMP> N. J. A. Sloane, A Handbook of Integer Sequences, Academic Press, 1973 (includes this sequence).</CMP>
    </omtext><omtext class="reference">
      <CMP> N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence).</CMP>
    </omtext><omtext class="link">
      <CMP> T. D. Noe, &lt;a href=&quot;/A000316/b000316.txt&quot;&gt;Table of n, a(n) for n=1..100&lt;/a&gt;</CMP>
    </omtext><omtext class="link">
      <CMP> F. F. Knudsen and I. Skau, &lt;a href=&quot;http://www.jstor.org/stable/2691467&quot;&gt;On the Asymptotic Solution of a Card-Matching Problem&lt;/a&gt;, Mathematics Magazine 69 (1996), 190-197.</CMP>
    </omtext><omtext class="link">
      <CMP> B. H. Margolius, &lt;a href=&quot;http://www.jstor.org/stable/3219303&quot;&gt;The Dinner-Diner Matching Problem&lt;/a&gt;, Mathematics Magazine, 76 (2003), 107-118.</CMP>
    </omtext><omtext class="link">
      <CMP> Barbara H. Margolius, &lt;a href=&quot;http://academic.csuohio.edu/bmargolius/homepage/dinner/dinner/cardentry.htm&quot;&gt;Dinner-Diner Matching Probabilities&lt;/a&gt;</CMP>
    </omtext><omtext class="link">
      <CMP> L. I. Nicolaescu, &lt;a href=&quot;http://nyjm.albany.edu/j/2004/10-7.pdf&quot;&gt;Derangements and asymptotics of the Laplace transforms of large powers of a polynomial&lt;/a&gt; New York J. Math. 10 (2004) 117-131.</CMP>
    </omtext><omtext class="link">
      <CMP> &lt;a href=&quot;/index/Ca#cardmatch&quot;&gt;Index entries for sequences related to card matching&lt;/a&gt;</CMP>
    </omtext><omdoc:p class="formula">
        <CMP>
         G.f.:<OMOBJ>
      <OMA>
      <OMS name="sum" cd="A000316"/>
      <OMA>
      <OMS name="coeff" cd="A000316"/>
      <OMA>
      <OMS name="R" cd="A000316"/>
      <OMV name="x"/>
    </OMA>
    </OMA>
    </OMA>
    </OMOBJ>,<OMOBJ>
      <OMV name="n"/>
    </OMOBJ>, k),<OMOBJ>
      <OMV name="x"/>
    </OMOBJ>, j)*(t-1)^j*(n*k-j)!, j=0..n*k) where<OMOBJ>
      <OMV name="n"/>
    </OMOBJ> is the number of kinds of cards,<OMOBJ>
      <OMV name="k"/>
    </OMOBJ> is the number of cards of each kind<OMOBJ>
      <OMI>2</OMI>
    </OMOBJ> in this case) and<OMOBJ>
      <OMA>
      <OMS name="R" cd="A000316"/>
      <OMV name="x"/>
    </OMA>
    </OMOBJ>,<OMOBJ>
      <OMV name="n"/>
    </OMOBJ>, k) is the rook polynomial given by<OMOBJ>
      <OMA>
      <OMS name="R" cd="A000316"/>
      <OMV name="x"/>
    </OMA>
    </OMOBJ>,<OMOBJ>
      <OMV name="n"/>
    </OMOBJ>, k)=(k!^2*sum(x^j/((k-j)!^2*j!))^n (see Riordan).<OMOBJ>
      <OMA>
      <OMS name="coeff" cd="A000316"/>
      <OMA>
      <OMS name="R" cd="A000316"/>
      <OMV name="x"/>
    </OMA>
    </OMA>
    </OMOBJ>,<OMOBJ>
      <OMV name="n"/>
    </OMOBJ>, k),<OMOBJ>
      <OMV name="x"/>
    </OMOBJ>, j) indicates the coefficient for<OMOBJ>
      <OMA>
      <OMS name="power" cd="arithmetics"/>
      <OMV name="x"/>
      <OMV name="j"/>
    </OMA>
    </OMOBJ> of the rook polynomial.
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
         a(n) = n! * sum((-1)^b * 2^{a+2b} * (2n-2a-b)! / (a! * b! * (n-a-b)!), a,b &gt;= 0, a+b &lt;= n) a(n) = n * a(n-1) + n! * 4^n * sum((-1)^a / (a! * 2^a),<OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMV name="a"/>
      <OMI>0</OMI>
    </OMA>
    </OMOBJ> to n) - _Dan Dima_, Dec 17 2006
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
         a(n) = 2^n * round(2^(n/2 + 3/4)*Pi^(-1/2)*exp(-2)*n!*BesselK(1/2+n,2^(1/2)))  - <OMOBJ>
      <OMV name="Mark"/>
    </OMOBJ> van Hoeij, Oct 30 2011.
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
         Recurrence: (2*n-3)*a(n) = 2*(n-1)*(2*n-1)^2*a(n-1) + 4*(n-1)*(2*n-3)*a(n-2) - 16*(n-2)*(n-1)*(2*n-1)*a(n-3). - _Vaclav Kotesovec_, Aug 07 2013
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
         a(n) = int {0..inf} exp(-x)*(x^2 - 4*x + 2)^n dx. Cf. A000166(n) = int {0..inf} exp(-x)*(x - 1)^n dx. Asymptotic: a(n) ~ (2*n)!*exp(-2)*( 1 - 1/(2*n) - 23/(96*n^2) + O(1/n^3) ). See Nicolaescu. - _Peter Bala_, Jul 07 2014
      </CMP>
      </omdoc:p><assertion class="example">
      <CMP> There are 80 ways of achieving zero matches when there are 2 cards of each kind and 3 kinds of card so A(3)=80.</CMP>
    </assertion><omtext class="maple">
      <CMP> p := (x,k)-&gt;k!^2*sum(x^j/((k-j)!^2*j!),j=0..k); R := (x,n,k)-&gt;p(x,k)^n; f := (t,n,k)-&gt;sum(coeff(R(x,n,k),x,j)*(t-1)^j*(n*k-j)!,j=0..n*k); seq(f(0,n,2), n=0..18);</CMP>
    </omtext><assertion class="crossref">
      <CMP> 2^n*A000459. A000166.</CMP>
    </assertion><assertion class="keywords">
      <CMP> nonn,easy,nice</CMP>
    </assertion><assertion class="offset">
      <CMP> 1,2</CMP>
    </assertion><assertion class="author">
      <CMP> _N. J. A. Sloane_.</CMP>
    </assertion><assertion class="extensions">
      <CMP> Formulae, more terms etc. from Barbara Haas Margolius (margolius(AT)math.csuohio.edu), Dec 22 2000</CMP>
    </assertion>
        </theory>
      </omdoc>