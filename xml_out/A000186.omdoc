<?xml version='1.0' encoding='UTF-8'?>
<omdoc xml:id="A000186.omdoc" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:omdoc="http://omdoc.org/ns" xmlns="http://omdoc.org/ns">
        <!--This OMDoc file is generated from an OEIS entry, do not edit-->
        <theory name="A000186">
          <assertion class="***** TTTT *****">
      <CMP> M2140 N0851</CMP>
    </assertion><omtext class="starts-with">
      <CMP> 1,0,0,2,24,552,21280,1073760,70299264,5792853248,587159944704,</CMP>
    </omtext><assertion class="***** UUUU *****">
      <CMP> 71822743499520,10435273503677440,1776780700509416448,</CMP>
    </assertion><assertion class="***** IIII *****">
      <CMP> 350461958856515690496,79284041282622163140608,20392765404792755583221760,5917934230798104348783083520,1924427226324694427836833857536</CMP>
    </assertion><omtext class="name">
      <CMP> Number of 3 X n Latin rectangles in which the first row is in order.</CMP>
    </omtext><omtext class="comment">
      <CMP> Or number of n X n matrices with exactly one 1 and one 2 in each row and column which are not in the main diagonal, other entries 0. - _Vladimir Shevelev_, Mar 22 2010</CMP>
    </omtext><omtext class="reference">
      <CMP> F. Alayont and N. Krzywonos, Rook Polynomials in Three and Higher Dimensions, http://faculty.gvsu.edu/alayontf/notes/rook_polynomials_higher_dimensions_preprint.pdf. 2012. - From _N. J. A. Sloane_, Jan 02 2013</CMP>
    </omtext><omtext class="reference">
      <CMP> K. P. Bogart and J. Q. Longyear, Counting 3 by n Latin rectangles, Proc. Amer. Math. Soc., 54 (1976), 463-467.</CMP>
    </omtext><omtext class="reference">
      <CMP> L. Comtet, Advanced Combinatorics, Reidel, 1974, p. 183.</CMP>
    </omtext><omtext class="reference">
      <CMP> Dulmage, A. L.; McMaster, G. E. A formula for counting three-line Latin rectangles. Proceedings of the Sixth Southeastern Conference on Combinatorics, Graph Theory and Computing (Florida Atlantic Univ., Boca Raton, Fla., 1975), pp. 279-289. Congressus Numerantium, No. XIV, Utilitas Math., Winnipeg, Man., 1975. MR0392611 (52 #13428). - From _N. J. A. Sloane_, Apr 06 2012</CMP>
    </omtext><omtext class="reference">
      <CMP> I. Gessel, Counting three-line Latin rectangles, Lect. Notes Math, 1234(1986), 106-111. [From _Vladimir Shevelev_, Mar 25 2010]</CMP>
    </omtext><omtext class="reference">
      <CMP> Goulden and Jackson, Combin. Enum., Wiley, 1983 p. 284.</CMP>
    </omtext><omtext class="reference">
      <CMP> S. M. Jacob, The enumeration of the Latin rectangle of depth three..., Proc. London Math. Soc., 31 (1928), 329-336.</CMP>
    </omtext><omtext class="reference">
      <CMP> S. M. Kerawala, The enumeration of the Latin rectangle of depth three by means of a difference equation, Bull. Calcutta Math. Soc., 33 (1941), 119-127.</CMP>
    </omtext><omtext class="reference">
      <CMP> S. M. Kerawala, The asymptotic number of three-deep Latin rectangles, Bull. Calcutta Math. Soc., 39 (1947), 71-72.</CMP>
    </omtext><omtext class="reference">
      <CMP> Koichi, Yamamoto, An asymptotic series for the number of three-line Latin rectangles, J. Math. Soc. Japan 1, (1950). 226-241.</CMP>
    </omtext><omtext class="reference">
      <CMP> W. Moser. A generalization of Riordan's formula for 3Xn Latin rectangles, Discrete Math., 40, 311-313 [From _Vladimir Shevelev_, Mar 25 2010]</CMP>
    </omtext><omtext class="reference">
      <CMP> J. Riordan, An Introduction to Combinatorial Analysis, Wiley, 1958, p. 210.</CMP>
    </omtext><omtext class="reference">
      <CMP> V. S. Shevelev, Reduced Latin rectangles and square matrices with identical sums in the rows and columns [Russian], Diskret. Mat., 4 (1992), no. 1, 91-110.</CMP>
    </omtext><omtext class="reference">
      <CMP> V. S. Shevelev, A generalized Riordan formula for three-rowed Latin rectangles and its applications, DAN of the Ukraine, 2 (1991), 8-12 (in Russian) [From _Vladimir Shevelev_, Mar 25 2010]</CMP>
    </omtext><omtext class="reference">
      <CMP> N. J. A. Sloane, A Handbook of Integer Sequences, Academic Press, 1973 (includes this sequence).</CMP>
    </omtext><omtext class="reference">
      <CMP> N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence).</CMP>
    </omtext><omtext class="reference">
      <CMP> D. S. Stones, The many formulae for the number of Latin rectangles, Electron. J. Combin 17 (2010), A1.</CMP>
    </omtext><omtext class="reference">
      <CMP> D. S. Stones and I. M. Wanless, Divisors of the number of Latin rectangles, J. Combin. Theory Ser. A 117 (2010), 204-215.</CMP>
    </omtext><omtext class="link">
      <CMP> N. J. A. Sloane, &lt;a href=&quot;/A000186/b000186.txt&quot;&gt;Table of n, a(n) for n = 0..207&lt;/a&gt;</CMP>
    </omtext><omtext class="link">
      <CMP> Vladimir Shevelev, &lt;a href=&quot;http://arxiv.org/abs/1104.4051&quot;&gt;SPECTRUM OF PERMANENTS VALUES AND ITS EXTREMAL MAGNITUDES ...&lt;/a&gt;, arXiv preprint arXiv:1104.4051, 2011.</CMP>
    </omtext><omtext class="link">
      <CMP> &lt;a href=&quot;/index/La#Latin&quot;&gt;Index entries for sequences related to Latin squares and rectangles&lt;/a&gt;</CMP>
    </omtext><omdoc:p class="formula">
        <CMP>
        <OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="a" cd="A000186"/>
      <OMV name="n"/>
    </OMA>
      <OMA><OMS name="times"/><OMA>
      <OMS name="factorial" cd="arithmetics"/>
      <OMV name="n"/>
    </OMA><OMS name="name">
      <OMBIND>
          <OMA>
            <OMS name="Sum" cd="arithmetics"/>
              <OMA>
                <OMS name="interval">
                  <OMA>
      <OMS name="&lt;=" cd="arithmetic"/>
      <OMA>
      <OMS name="plus" cd="arithmetics"/>
      <OMV name="k"/><OMV name="j"/>
    </OMA>
      <OMV name="n"/>
    </OMA>
                  
                </OMS>
              </OMA>
              <OMBVAR>
                
              </OMBVAR>
            <OMA>
      <OMS name="divide" cd="arithmetics"/>
      <OMA>
      <OMS name="power" cd="arithmetics"/>
      <OMI>2</OMI>
      <OMV name="j"/>
    </OMA><OMA>
      <OMS name="factorial" cd="arithmetics"/>
      <OMV name="j"/>
    </OMA>
    </OMA>
          </OMA>
      </OMBIND>
    </OMS><OMA>
      <OMS name="factorial" cd="arithmetics"/>
      <OMV name="k"/>
    </OMA><OMA>
      <OMS name="binomial" cd="A000186"/>
      <OMA>
      <OMS name="unary_minus"/>
      <OMA><OMS name="times"/><OMI>3</OMI><OMA>
      <OMS name="plus" cd="arithmetics"/>
      <OMV name="k"/><OMI>1</OMI>
    </OMA></OMA>
    </OMA>
    </OMA></OMA>
    </OMA>
    </OMOBJ>, n-k-j).
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
         Note that the formula Sum_{k=0..n, k &lt;= n/2} binomial(n, k)D(n-k)*D(k)*U(n-2*k), where D() = A000166, U() = A000179 given by Riordan,<OMOBJ>
      <OMV name="p"/>
    </OMOBJ>.<OMOBJ>
      <OMI>209</OMI>
    </OMOBJ> gives the wrong answers unless we set<OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="U" cd="A000186"/>
      <OMI>1</OMI>
    </OMA>
      <OMA>
      <OMS name="unary_minus"/>
      <OMA><OMS name="times"/><OMI>1</OMI><OMV name="or"/></OMA>
    </OMA>
    </OMA>
    </OMOBJ> in other words we must take U() = A102761). With<OMOBJ>
      <OMA>
      <OMS name="=" cd="arithmetic"/>
      <OMA>
      <OMS name="U" cd="A000186"/>
      <OMI>1</OMI>
    </OMA>
      <OMI>0</OMI>
    </OMA>
    </OMOBJ> it produces<OMOBJ>
      <OMR xref="A170904"/>
    </OMOBJ>. See the Maple code here. - _N. J. A. Sloane_, Jan 21 2010, Apr 04 2010. Thanks to _Vladimir Shevelev_ for clarifying this comment.
      </CMP>
      </omdoc:p><omdoc:p class="formula">
        <CMP>
         E.g.f.: exp(2*x) Sum(n&gt;=0; n! x^n /(1+x)^(3*n+3)) from Gessel reference. - _Wouter Meeussen_, Nov 02 2013
      </CMP>
      </omdoc:p><omtext class="maple">
      <CMP> for n from 1 to 250 do t0:=0; for j from 0 to n do for k from 0 to n-j do t0:=t0 + (2^j/j!)*k!*binomial(-3*(k+1), n-k-j); od: od: t0:=n!*t0; lprint(n,t0); od:</CMP>
    </omtext><omtext class="maple">
      <CMP> Maple code for A000186 based on Eq. (30) of Riordan, p. 205. Eq. (30a) on p. 206 is wrong. - _N. J. A. Sloane_, Jan 21 2010. Thanks to Neven Juric for correcting an error in the definition of fU, Mar 01 2010</CMP>
    </omtext><omtext class="maple">
      <CMP> # A000166</CMP>
    </omtext><omtext class="maple">
      <CMP> unprotect(D);</CMP>
    </omtext><omtext class="maple">
      <CMP> D := proc(n) option remember; if n&lt;=1 then 1-n else (n-1)*(D(n-1)+D(n-2)); fi; end;</CMP>
    </omtext><omtext class="maple">
      <CMP> [seq(D(n),n=0..30)];</CMP>
    </omtext><omtext class="maple">
      <CMP> # A000179</CMP>
    </omtext><omtext class="maple">
      <CMP> U := proc(n) if n&lt;=1 then 1-n else</CMP>
    </omtext><omtext class="maple">
      <CMP> add ((-1)^k*(2*n)*binomial(2*n-k, k)*(n-k)!/(2*n-k), k=0..n); fi; end;</CMP>
    </omtext><omtext class="maple">
      <CMP> [seq(U(n),n=0..30)];</CMP>
    </omtext><omtext class="maple">
      <CMP> # funny A000179</CMP>
    </omtext><omtext class="maple">
      <CMP> fU := proc(n) global U; if n&lt;=-2 then U(-n) elif abs(n)=1 then -1 elif n=0 then 2 else U(n); fi; end;</CMP>
    </omtext><omtext class="maple">
      <CMP> [seq(fU(n),n=-10..10)];</CMP>
    </omtext><omtext class="maple">
      <CMP> # A000186</CMP>
    </omtext><omtext class="maple">
      <CMP> K:=proc(n) local k; global D, fU; (1/2)*add( binomial(n,k)*D(n-k)*D(k)*fU(n-2*k), k=0..n ); end;</CMP>
    </omtext><omtext class="maple">
      <CMP> [seq(K(n),n=0..30)];</CMP>
    </omtext><omtext class="maple">
      <CMP> # another Maple program:</CMP>
    </omtext><omtext class="maple">
      <CMP> a:= proc(n) option remember; `if`(n&lt;5, [1, 0, 0, 2, 24][n+1],</CMP>
    </omtext><omtext class="maple">
      <CMP>      ((n-1)*(n^2-2*n+2)*a(n-1) +(n-1)*(n-2)*(n^2-2*n+2)*a(n-2)</CMP>
    </omtext><omtext class="maple">
      <CMP>       +(n-1)*(n-2)*(n^2-2*n-2) *a(n-3)</CMP>
    </omtext><omtext class="maple">
      <CMP>       +2*(n-1)*(n-2)*(n-3)*(n^2-5*n+3) *a(n-4)</CMP>
    </omtext><omtext class="maple">
      <CMP>       -4*(n-2)*(n-3)*(n-4)*(n-1)^2 *a(n-5)) / (n-2))</CMP>
    </omtext><omtext class="maple">
      <CMP>     end:</CMP>
    </omtext><omtext class="maple">
      <CMP> seq(a(n), n=0..25);  # _Alois P. Heinz_, Nov 02 2013</CMP>
    </omtext><omtext class="mathematica">
      <CMP> a[n_] := (t0 = 0; Do[t0 = t0 + (2^j/j!)*k!*Binomial[-3*(k+1), n-k-j], {j, 0, n}, {k, 0, n-j}]; n!*t0); Table[a[n], {n, 0, 18}] (* _Jean-François Alcover_, Oct 13 2011, after Maple *)</CMP>
    </omtext><assertion class="crossref">
      <CMP> Cf. A000512.</CMP>
    </assertion><assertion class="keywords">
      <CMP> nonn,nice,easy</CMP>
    </assertion><assertion class="offset">
      <CMP> 0,4</CMP>
    </assertion><assertion class="author">
      <CMP> _N. J. A. Sloane_</CMP>
    </assertion><assertion class="extensions">
      <CMP> Formula and more terms from _Vladeta Jovovic_, Mar 31 2001</CMP>
    </assertion><assertion class="extensions">
      <CMP> Edited by _N. J. A. Sloane_, Jan 21 2010, Mar 04 2010, Apr 04 2010</CMP>
    </assertion>
        </theory>
      </omdoc>